<!DOCTYPE html>
<html lang="ko">
<head>
  {% load static %}
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì°¸ê³ í•´ë¼ - ê³µêµ° ì§€ì› ì •ë³´ ì„œë¹„ìŠ¤</title>

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- FullCalendar CSS -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet" />

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- fullPage.js CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullPage.js/4.0.13/fullpage.min.css" />

  <style>
    /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Nunito', sans-serif;
      height: 100%;
      width: 100%;
    }

    /* ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
    .section {
      height: 100vh;
      width: 100%;
      position: relative;
    }

    /* ì„¹ì…˜ 1 ë°°ê²½ ì´ë¯¸ì§€ */
    #section1 {
      background-image: url('{% static "images/airforcebg.svg" %}');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ì„¹ì…˜ 2 ë°°ê²½ ìƒ‰ìƒ */
    #section2 {
      background-color: #f8f9fa;
    }

    /* FullCalendar ìŠ¤íƒ€ì¼ */
    .fc-toolbar-title {
      font-size: 1.75rem;
      font-weight: 600;
      color: #2C3E50;
    }

    .fc-button {
      background-color: #6c757d !important;
      border: none !important;
      padding: 10px 20px !important;
      color: white !important;
      font-weight: 600 !important;
      border-radius: 5px !important;
    }

    .fc-button:hover {
      background-color: #5a6268 !important;
    }

    .fc-event {
      background-color: skyblue !important;
      border: none !important;
      color: white !important;
      font-weight: 600 !important;
      padding: 2px 5px !important;
      border-radius: 4px !important;
    }

    .fc-today {
      background-color: rgba(108, 117, 125, 0.2) !important;
    }

    #calendar {
      width: 90%;
      height: 700px;
      max-width: 1200px;
      margin: 0 auto;
    }

    /* í¼ ìŠ¤íƒ€ì¼ */
    #score-form {
      max-width: 1200px;
      width: 90%;
      margin: 0 auto;
      padding: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    #score-form label {
      font-weight: 600;
      font-size: 1.1rem;
    }

  

    #score-form button {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
      font-size: 1.2rem;
    }

    .additional-score-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
    }

    /* ë°˜ì‘í˜• ë””ìì¸ */
    @media (max-width: 1400px) {
      #score-form {
        width: 95%;
      }
      .additional-score-grid {
        grid-template-columns: repeat(4, 1fr);
      }
    }

    @media (max-width: 768px) {
      .additional-score-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 480px) {
      .additional-score-grid {
        grid-template-columns: 1fr;
      }
    }

    /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 8px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      position: relative;
    }

    .modal-content button.close-modal {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #555;
    }
  </style>
</head>
<body>
  <div id="fullpage">
    <!-- ì„¹ì…˜ 1 -->
    <div class="section" data-anchor="section1" id="section1">
      <!-- ì½˜í…ì¸  ë°•ìŠ¤ -->
      <div class="content-wrapper text-center z-10 px-8 py-16 bg-white bg-opacity-80 shadow-xl rounded-lg">
        <h1 class="text-6xl font-extrabold text-blue-600 animate-fade-in">ğŸª– ê³µêµ° ì§€ì› ì •ë³´ ì„œë¹„ìŠ¤</h1><br>
        <h1 class="text-6xl font-extrabold text-blue-600 animate-fade-in">"ì°¸ê³ í•´ë¼"</h1>
        <p class="mt-6 text-xl text-gray-800">ê°€ê¸° ì‹«ì€ êµ°ëŒ€, ê³µêµ°ì´ë¼ë„ ê°€ì..</p>
        <p class="mt-6 text-xl text-gray-800">ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤í•´ ì§€ì› ì •ë³´ì™€ í•©ê²© ê°€ëŠ¥ì„±ì„ ì•Œì•„ë³´ì.</p>
        <div class="mt-8">
          <a href="#section2" class="inline-block px-6 py-3 text-white bg-blue-500 hover:bg-blue-600 rounded-lg shadow-lg transition duration-300 ease-in-out">
            ê´€ë ¨ ì¼ì • ë³´ëŸ¬ê°€ê¸°
          </a>
        </div>
      </div>
    </div>

    <!-- ì„¹ì…˜ 2 -->
    <div class="section" data-anchor="section2" id="section2">
      <div class="container mx-auto py-8">
        <h1 class="text-3xl font-bold text-center text-blue-600 mb-6">ê³µêµ° ì§€ì›ì¼ & ìê²©ì¦ ì‹œí—˜ì¼ ìº˜ë¦°ë”</h1>
        <div id="calendar" class="bg-white p-4 rounded-lg shadow-lg"></div>
      </div>
    </div>

    <!-- ì„¹ì…˜ 3 -->
    <div class="section" data-anchor="section3" id="section3">
      <h1 class="text-3xl font-bold text-center text-blue-600 mb-6">ê³µêµ° ì¼ë°˜ ê¸°ìˆ ë³‘ ì ìˆ˜ ê³„ì‚°ê¸°</h1>
      <p class="text-center text-gray-600 mb-10">ì•„ë˜ì—ì„œ ê³¨ë¼ í•©ê²©ì„ ì˜ˆì¸¡í•´ë³´ì„¸ìš”!</p>

      <form method="POST" class="space-y-4" id="score-form">
        {% csrf_token %}

        <!-- ìê²©/ë©´í—ˆ ì ìˆ˜ -->
        <div>
          <label for="license_score" class="block text-lg font-semibold text-gray-700 mb-2">ìê²©/ë©´í—ˆ ì ìˆ˜</label>
          <select name="license_score" id="license_score" required>
            <option value="0">ìê²©ì¦ ì—†ìŒ (0ì )</option>
            <option value="60">ì¼ë°˜ìê²©ì¦ - L2 (60ì )</option>
            <option value="62">ì¼ë°˜ìê²©ì¦ - L4, L3 (62ì )</option>
            <option value="64">ì¼ë°˜ìê²©ì¦ - L6, L5 (64ì )</option>
            <option value="66">êµ­ê°€ê¸°ìˆ ìê²©ì¦ - ê¸°ëŠ¥ì‚¬ (66ì )</option>
            <option value="68">êµ­ê°€ê¸°ìˆ ìê²©ì¦ - ì‚°ì—…ê¸°ì‚¬ (68ì )</option>
            <option value="70">êµ­ê°€ê¸°ìˆ ìê²©ì¦ - ê¸°ì‚¬ ì´ìƒ (70ì )</option>
          </select>
        </div>

        <!-- ì¶œê²° ì ìˆ˜ -->
        <div>
          <label for="attendance_score" class="block text-lg font-semibold text-gray-700 mb-2">ì¶œê²° ì ìˆ˜</label>
          <select name="attendance_score" id="attendance_score" required>
            <option value="16">ê²°ì„ 7ì¼ ì´ìƒ (16ì )</option>
            <option value="17">ê²°ì„ 5~6ì¼ (17ì )</option>
            <option value="18">ê²°ì„ 3~4ì¼ (18ì )</option>
            <option value="19">ê²°ì„ 1~2ì¼ (19ì )</option>
            <option value="20">ê²°ì„ 0ì¼ (20ì )</option>
          </select>
        </div>

        <!-- ë©´ì ‘ ì ìˆ˜ -->
        <div>
          <label for="interview_score" class="block text-lg font-semibold text-gray-700 mb-2">ë©´ì ‘ ì ìˆ˜</label>
          <select name="interview_score" id="interview_score" required>
            <option value="25">ë©´ì ‘ í‰ê°€ ë¶€ì¡± (25ì )</option>
            <option value="30">ë©´ì ‘ í‰ê°€ ë³´í†µ (30ì )</option>
            <option value="35">ë©´ì ‘ í‰ê°€ ìš°ìˆ˜ (35ì )</option>
          </select>
        </div>

        <!-- ê°€ì‚°ì  -->
        <div>
          <label class="block text-lg font-semibold text-gray-700 mb-2">ê°€ì‚°ì </label>
          <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4">
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="1" id="option9" class="form-checkbox h-4 w-4 text-blue-600">
              <label for="option9" class="text-sm text-gray-700">ë³‘ì—­ì§„ë¡œì„¤ê³„ êµ° ì¶”ì²œíŠ¹ê¸° (1ì )</label>
            </div>
        
            <!-- ë‹¤ìë…€(2ì¸) ê°€ì •ìë…€ -->
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="2" id="option6" class="form-checkbox h-4 w-4 text-blue-600 align-middle">
              <label for="option6" class="text-gray-700 text-sm">ë‹¤ìë…€(2ì¸) ê°€ì •ìë…€ (2ì )</label>
            </div>

            <!-- ë‹¤ìë…€(3ì¸ ì´ìƒ) ê°€ì •ìë…€ -->
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="4" id="option5" class="form-checkbox h-4 w-4 text-blue-600 align-middle">
              <label for="option5" class="text-gray-700 text-sm">ë‹¤ìë…€(3ì¸ ì´ìƒ) ê°€ì •ìë…€ (4ì )</label>
            </div>
        
        
            <!-- êµ­ê°€ ìœ ê³µì ìë…€/ì†ìë…€ -->
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="4" id="option1" class="form-checkbox h-4 w-4 text-blue-600 align-middle">
              <label for="option1" class="text-gray-700 text-sm">êµ­ê°€ ìœ ê³µì ìë…€/ì†ìë…€ (4ì )</label>
            </div>
        
            <!-- ì§ˆë³‘ì¹˜ìœ  ìì§„ì…ëŒ€ -->
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="4" id="option2" class="form-checkbox h-4 w-4 text-blue-600 align-middle">
              <label for="option2" class="text-gray-700 text-sm">ì§ˆë³‘ì¹˜ìœ  ìì§„ì…ëŒ€ (4ì )</label>
            </div>
        
            <!-- í˜„ì—­ë³‘ ì…ì˜ëŒ€ìƒìœ¼ë¡œ ì—­ì¢… ë³€ê²½ -->
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="4" id="option3" class="form-checkbox h-4 w-4 text-blue-600 align-middle">
              <label for="option3" class="text-gray-700 text-sm">í˜„ì—­ë³‘ ì…ì˜ëŒ€ìƒìœ¼ë¡œ ì—­ì¢… ë³€ê²½ (4ì )</label>
            </div>
        
            <!-- êµ­ì™¸ì´ì£¼ì ì¤‘ í˜„ì—­ë³µë¬´ì§€ì›ì -->
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="4" id="option4" class="form-checkbox h-4 w-4 text-blue-600 align-middle">
              <label for="option4" class="text-gray-700 text-sm">êµ­ì™¸ì´ì£¼ì ì¤‘ í˜„ì—­ë³µë¬´ì§€ì›ì (4ì )</label>
            </div>
        

        
            <!-- ê²½ì œì  ì•½ì ì§€ì›ëŒ€ìƒ -->
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="4" id="option7" class="form-checkbox h-4 w-4 text-blue-600 align-middle">
              <label for="option7" class="text-gray-700 text-sm">ê²½ì œì  ì•½ì ì§€ì›ëŒ€ìƒ (4ì )</label>
            </div>
        
            <!-- ì‚¬íšŒë´‰ì‚¬í™œë™ ê²½ë ¥ -->
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="8" id="option8" class="form-checkbox h-4 w-4 text-blue-600 align-middle">
              <label for="option8" class="text-gray-700 text-sm">ì‚¬íšŒë´‰ì‚¬í™œë™ ê²½ë ¥ (ìµœëŒ€ 8ì )</label>
            </div>
                
            <!-- TOEIC 520 ~ 729ì  -->
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="1" id="option14" class="form-checkbox h-4 w-4 text-blue-600 align-middle">
              <label for="option14" class="text-gray-700 text-sm">TOEIC 520 ~ 729ì  (1ì )</label>
            </div>
        
            <!-- TOEIC 730ì  ì´ìƒ -->
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="2" id="option15" class="form-checkbox h-4 w-4 text-blue-600 align-middle">
              <label for="option15" class="text-gray-700 text-sm">TOEIC 730ì  ì´ìƒ (2ì )</label>
            </div>

            <!-- í•œêµ­ì–´ëŠ¥ë ¥ê²€ì • 1, 2ê¸‰ -->
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="2" id="option17" class="form-checkbox h-4 w-4 text-blue-600 align-middle">
              <label for="option17" class="text-gray-700 text-sm">í•œêµ­ì–´ëŠ¥ë ¥ê²€ì • 1, 2ê¸‰ (2ì )</label>
            </div>
            <!-- í•œêµ­ì–´ëŠ¥ë ¥ê²€ì • 3, 4ê¸‰ -->
            <div class="flex items-center space-x-2">
              <input type="checkbox" name="additional_score[]" value="1" id="option16" class="form-checkbox h-4 w-4 text-blue-600 align-middle">
              <label for="option16" class="text-gray-700 text-sm">í•œêµ­ì–´ëŠ¥ë ¥ê²€ì • 3, 4ê¸‰ (1ì )</label>
            </div>
        

          </div>
        </div>
        
        

        <!-- ì œì¶œ ë° ì´ˆê¸°í™” ë²„íŠ¼ -->
        <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white rounded-lg">ì ìˆ˜ ê³„ì‚°í•˜ê¸°</button>
        <button type="button" class="bg-gray-500 hover:bg-gray-600 text-white rounded-lg mt-4" onclick="resetForm();">ì´ˆê¸°í™”</button>

        <!-- ê²°ê³¼ í‘œì‹œ -->
        <div id="result" class="mt-8 bg-green-100 p-4 rounded-lg text-center text-lg">ê²°ê³¼</div>
      </form>
    </div>
  </div>

  <!-- JavaScript ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fullPage.js/4.0.13/fullpage.min.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      initializeFullPage();
      initializeCalendar();
      setupFormHandler();
    });

    /**
     * fullPage.js ì´ˆê¸°í™” í•¨ìˆ˜
     */
    function initializeFullPage() {
      new fullpage('#fullpage', {
        autoScrolling: false,
        fitToSection: true,
        navigation: true,
        anchors: ['section1', 'section2', 'section3'],
        navigationTooltips: ['ì²« í™”ë©´', 'ì¼ì •', 'í•©ê²© ì˜ˆì¸¡'],
        showActiveTooltip: true,
        scrollingSpeed: 700,
        scrollBar: false,
      });

      // ìº˜ë¦°ë” ë Œë”ë§ í›„ fullPage.js ì¬ë¹Œë“œ
      setTimeout(() => {
        fullpage_api.reBuild();
      }, 500);
    }

    /**
     * FullCalendar ì´ˆê¸°í™” í•¨ìˆ˜
     */
    function initializeCalendar() {
      const calendarEl = document.getElementById('calendar');
      const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        locale: 'ko',
        events: '/calendar/events/',  // ì´ë²¤íŠ¸ ë°ì´í„° URLì„ ìˆ˜ì •í•˜ì„¸ìš”
        headerToolbar: {
          left: 'prev,next today',
          center: 'title',
          right: 'dayGridMonth'
        },
        buttonText: {
          today: 'ì˜¤ëŠ˜',
          month: 'ì›”',
          week: 'ì£¼',
          day: 'ì¼'
        },
        eventClick: handleEventClick
      });
      calendar.render();
    }

    /**
     * ì´ë²¤íŠ¸ í´ë¦­ ì‹œ ëª¨ë‹¬ í‘œì‹œ í•¸ë“¤ëŸ¬
     * @param {Object} info - ì´ë²¤íŠ¸ ì •ë³´
     */
    function handleEventClick(info) {
      const { title, start, end, extendedProps } = info.event;
      const modalHtml = `
        <div class="modal-overlay">
          <div class="modal-content">
            <button class="close-modal" onclick="closeModal();">Ã—</button>
            <h5 class="text-xl font-bold">${title}</h5>
            <div class="mt-4">
              <p><strong>ì‹œì‘ì¼:</strong> ${formatDate(start)}</p>
              <p><strong>ì¢…ë£Œì¼:</strong> ${end ? formatDate(end) : 'N/A'}</p>
              <p><strong>ì¶”ê°€ ì •ë³´:</strong> ${extendedProps.content || 'ì¶”ê°€ ì •ë³´ ì—†ìŒ'}</p>
            </div>
            <div class="mt-4 text-right">
              <button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded" onclick="closeModal();">ë‹«ê¸°</button>
            </div>
          </div>
        </div>
      `;
      const modalContainer = document.createElement('div');
      modalContainer.id = 'eventModal';
      modalContainer.innerHTML = modalHtml;
      document.body.appendChild(modalContainer);
    }

    /**
     * ë‚ ì§œ í˜•ì‹ ë³€í™˜ í•¨ìˆ˜
     * @param {Date} date - ë‚ ì§œ ê°ì²´
     * @returns {string} - í¬ë§·ëœ ë‚ ì§œ ë¬¸ìì—´
     */
    function formatDate(date) {
      return date.toLocaleDateString();
    }

    /**
     * ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜
     */
    function closeModal() {
      const modal = document.getElementById('eventModal');
      if (modal) {
        modal.remove();
      }
    }

    /**
     * í¼ ì´ˆê¸°í™” í•¨ìˆ˜
     */
    function resetForm() {
      const form = document.getElementById('score-form');
      form.reset();
      document.getElementById('result').innerHTML = '';
    }

    /**
     * ì ìˆ˜ ê³„ì‚° í¼ ì œì¶œ í•¸ë“¤ëŸ¬ ì„¤ì • í•¨ìˆ˜
     */
    function setupFormHandler() {
      const form = document.getElementById('score-form');
      form.addEventListener('submit', handleFormSubmit);
    }

    /**
     * ì ìˆ˜ ê³„ì‚° í¼ ì œì¶œ í•¸ë“¤ëŸ¬
     * @param {Event} event - ì œì¶œ ì´ë²¤íŠ¸
     */
    function handleFormSubmit(event) {
      event.preventDefault();

      const formData = new FormData(event.target);
      const additionalScores = formData.getAll('additional_score[]').map(Number);
      const additionalScoreTotal = additionalScores.reduce((acc, score) => acc + score, 0);
      const licenseScore = Number(formData.get('license_score'));
      const attendanceScore = Number(formData.get('attendance_score'));
      const interviewScore = Number(formData.get('interview_score'));
      const totalScore = licenseScore + attendanceScore + interviewScore + additionalScoreTotal;

      const csrfToken = formData.get('csrfmiddlewaretoken');

      fetch('/calculate-score/', {
        method: 'POST',
        headers: {
          'X-CSRFToken': csrfToken,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          license_score: licenseScore,
          attendance_score: attendanceScore,
          interview_score: interviewScore,
          additional_scores: additionalScores
        })
      })
      .then(response => response.json())
      .then(data => displayResult(data))
      .catch(error => console.error('Error:', error));
    }

    /**
   /**
 * ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜
 * @param {Object} data - ì„œë²„ë¡œë¶€í„° ë°›ì€ ë°ì´í„°
 */
/**
 * ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜
 * @param {Object} data - ì„œë²„ë¡œë¶€í„° ë°›ì€ ë°ì´í„°
 */
 function displayResult(data) {
  const resultContainer = document.getElementById('result');

  // ë°ì´í„°ê°€ ì œëŒ€ë¡œ ë“¤ì–´ì™”ëŠ”ì§€ í™•ì¸í•˜ê³ , ì—†ëŠ” ê²½ìš° ê¸°ë³¸ê°’ ì„¤ì •
  const totalScore = data.total_score || 0;
  const result = data.result || 'ê²°ê³¼ ì—†ìŒ';
  const predictedCutoff = data.predicted_cutoff !== undefined ? data.predicted_cutoff.toFixed(2) : 'ì˜ˆì¸¡ ë¶ˆê°€';
  const latestCutoff = data.latest_cutoff !== undefined ? data.latest_cutoff : 'ë¶ˆëª…';

  // ì„œë²„ë¡œë¶€í„° ë°›ì€ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê²°ê³¼ í‘œì‹œ
  if (resultContainer) {
    resultContainer.innerHTML = `
      <p><strong>ì´ì :</strong> ${totalScore}ì </p>
      <p><strong>ê²°ê³¼:</strong> ${result}</p>
      <p><strong>ì˜ˆìƒ ì»¤íŠ¸ë¼ì¸:</strong> ${predictedCutoff}ì </p>
      <p><strong>ê°€ì¥ ìµœê·¼ ì»¤íŠ¸ë¼ì¸:</strong> ${latestCutoff}ì </p>
    `;
  } else {
    console.error("Result container not found.");
  }
}

      // ê²°ê³¼ ë Œë” í›„ fullPage.js ì¬ë¹Œë“œ
      setTimeout(() => {
        fullpage_api.reBuild();
      }, 500);
    
  </script>
</body>
</html>
